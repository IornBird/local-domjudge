# 最終目標

建立本地的程式批改器，考生上傳程式後，機器可以自動輸入側資與隱藏側資，並報告各自是否通過。

(實作此程式的原因，是因為考試場域網路有問題，無法做online judge)

## 考生操作方式

1. 身分驗證或使用訪客身分

2. 下載題目(PDF)

3. 提供寫好的程式

4. 選擇題號

5. 程式提供編譯是否成功，然後各側資是否通過

6. 學生選擇下載特定公開側資(隱藏側資不予查看)

學生查證的大致介面範例：

| 公開測資                | 隱藏側資          |
| ------------------- | ------------- |
| 通過(下載測資)            | wrong         |
| wrong answer(下載測資)  | 通過            |
| Runtime-error(下載測資) | Runtime-error |

## 教師操作方式

- 身分驗證

- 提供題目(PDF)

- 提供該題的編譯腳本

- 提供側資

- 提供隱藏側資

- 上述皆提供完畢後，程式「將隱藏側資加密，與公開側資、題目一起打包為輸出檔(可為zip或自定義)」

## 身分

### 學生

權限

- 開啟封裝檔的題目敘述與公開測資部分

- 上傳程式，指定題號後請求批改

- 查看測資各自批改結果

- 下載公開測資(含輸入與輸出)

限制

- 需要公開密碼才可擁有權限

- 不可存取隱藏測資

### 教師

權限

- 身兼管理員，可查看封裝檔的所有內容

- 擁有所有學生的權限(方便測試)，不必二次登入

- 指定題號與測試語言。然後將題目敘述、公開測資、隱藏測資上傳，請求打包為封裝檔

限制

- 需要帳號與專用密碼才可擁有權限

- (考慮中) 學生版不支援教師身分

## 密碼

程式運行中不提供密碼更改。(也就是說，若要更改密碼，需重新編譯程式)

公開密碼

- 盡量不留電磁紀錄

- 在測驗開始時，已非電訊號方式傳遞給學生

- 輸入後，可以直接解密題目與公開測資。

專用密碼

- 盡量不留電磁紀錄，教師須自行記憶

- 輸入後，可以解密題目敘述、公開測資、隱藏測資

- (考慮中) 學生版無法使用

## 題目

題目敘述

- 為單一PDF檔案

測資

- 雖然實質內容是文字，為避免編碼問題，以二進制方式儲存

- 檔案取名方式：
  
  - 資料夾：公開(public)或隱藏(private)
  
  - 檔名：編號
  
  - 副檔名：輸入(.in)或期望輸出(.out)
  
  - 範例：`public/1.in`、`private/2.out`等。

- 操作方式：對學生程式輸入測資，並檢查相同編號的期望輸出，是否與學生程式相同。

- 在學生身分下，隱藏測資必須保持加密狀態，只有輸入當下可以解密，輸入完畢後，必須消除(或確保不存在)解密結果的電磁紀錄。

### 封裝檔

包含上述「題目」的所有部分，以及必要文件(指定語言、Meta File等)，加密後封裝為單一檔案

一題為一個封裝檔

有權限者，可以做對應的解封裝與解密

### 動作

注意：此程式不會使用網路連線。與網路相關用語，僅為名詞借用。

上傳

- 請求程式為讀取、複製、包裝等操作

- 請注意使用者是否有該權限

下載

- 向程式請求解封裝(解密)內部檔案。若需要，可以複製檔案到桌面或指定路徑。

- 請注意使用者是否有該權限

批改

- 學生可以上傳單一原始碼檔案，選擇題號

- 根據題目對應語言，以程式內部準備的編譯器，編譯原始碼檔案為執行檔

- 若編譯失敗，顯示編譯錯誤訊息

- 若無編譯失敗，以所有測資測試執行檔，並提供測資測試結果。
  
  - 若為Runtime-error，請顯示錯誤訊息
  
  - 若為運行超時，請只表示運行超時
  
  - 若程式正常結束，為避免洩漏影藏測資，請只表示答案是否正確

- (考慮中) 執行檔可以不保留，或只保留最後一次。

## 其他

可以使用command line完成所有操作。

至少需要支援C++ 17、Lex和yacc。後兩者版本在後續討論。

只需支援Unix-like作業系統。
